# AleshaBot - RSS Telegram Bot

## Описание

AleshaBot - это Telegram-бот, предназначенный для мониторинга RSS/Atom лент и автоматической публикации новых записей в указанные Telegram каналы или группы. Бот позволяет настраивать задержку публикации для каждой ленты и добавлять пользовательские хештеги к постам для каждой подписки канала на ленту.

## Возможности

*   **Управление RSS-лентами:**
    *   Добавление новых RSS/Atom лент по URL.
    *   Просмотр списка добавленных лент с пагинацией.
    *   Удаление лент.
    *   Установка индивидуальной задержки публикации (в минутах) для каждой ленты. Посты будут опубликованы не ранее, чем через указанное количество минут после их появления в ленте.
*   **Управление Каналами:**
    *   Добавление Telegram каналов/групп по их ID (например, `-1001234567890`) или username (`@channelname`).
    *   Просмотр списка добавленных каналов с пагинацией.
    *   Удаление каналов.
*   **Управление Подписками:**
    *   Подписка канала на одну или несколько RSS-лент.
    *   Отписка канала от ленты.
    *   Просмотр подписок конкретного канала.
    *   Добавление/Редактирование/Удаление набора хештегов для каждой отдельной подписки (канал + лента). Хештеги автоматически добавляются в конец публикуемого сообщения.
*   **Принудительная Проверка:**
    *   Возможность запустить немедленную проверку всех лент или одной конкретной ленты по ID через команду `/forcecheck [id]`.
*   **Планировщик:**
    *   Автоматическая проверка лент с заданным интервалом (по умолчанию - каждые 5 минут, настраивается).
    *   Автоматическая публикация отложенных постов с учетом установленной задержки (проверяется каждую минуту).
*   **Режимы Работы:**
    *   **Приватный (private):** Только пользователи, чьи ID указаны в `ADMIN_USER_IDS`, могут взаимодействовать с ботом.
    *   **Публичный (public):** Любой пользователь может взаимодействовать с ботом, управляя своими собственными лентами, каналами и подписками. Данные изолированы для каждого пользователя.
*   **Локализация:**
    *   Поддержка нескольких языков интерфейса (на данный момент Русский и Английский). Язык выбирается пользователем в настройках.
*   **База данных:**
    *   Использует SQLAlchemy для работы с базой данных (по умолчанию SQLite), хранит информацию о лентах, каналах, подписках, пользователях и опубликованных постах.

## Установка

1.  **Клонируйте репозиторий** (если вы еще этого не сделали):
    ```bash
    git clone <repository_url>
    cd AleshaBot
    ```
2.  **Убедитесь, что у вас установлен Python 3.**
3.  **Создайте файл `.env`:**
    *   Скопируйте файл `rss_telegram_bot/.env.example` и переименуйте копию в `rss_telegram_bot/.env`.
    *   Откройте `.env` и вставьте токен вашего Telegram бота в переменную `TELEGRAM_BOT_TOKEN`. Получить токен можно у @BotFather в Telegram.
    *   **Настройте администраторов (для приватного режима):**
        *   Найдите переменную `ADMIN_USER_IDS`.
        *   Укажите через запятую числовые ID пользователей Telegram, которые будут иметь доступ к боту в приватном режиме. Например: `ADMIN_USER_IDS=12345678,98765432`. Узнать свой ID можно, например, у бота @userinfobot.
        *   **Важно:** Если вы оставляете `ADMIN_USER_IDS` пустым и `BOT_MODE` установлен в `private` (по умолчанию в `config.py`), никто не сможет использовать бота.
    *   **(Опционально) Настройте режим работы:**
        *   Переменная `BOT_MODE` в файле `rss_telegram_bot/config.py` определяет режим работы (`private` или `public`). По умолчанию `private`.
    *   **(Опционально) Настройте URL базы данных:**
        *   Переменная `DATABASE_URL` в `.env` определяет строку подключения к БД. По умолчанию используется SQLite (`sqlite:///rss_bot.db`), файл будет создан в директории `rss_telegram_bot`. Вы можете указать другую СУБД, поддерживаемую SQLAlchemy (например, PostgreSQL: `postgresql://user:password@host:port/database`).

## Запуск

Для удобства используйте предоставленные стартовые скрипты, находящиеся в директории `rss_telegram_bot`:

*   **Windows:**
    *   Запустите файл `start.bat`.
*   **Linux / macOS:**
    *   Откройте терминал в директории `rss_telegram_bot`.
    *   Сделайте скрипт исполняемым (только один раз): `chmod +x start.sh`
    *   Запустите скрипт: `./start.sh`

Эти скрипты автоматически выполнят следующие действия:
1.  Проверят наличие виртуального окружения Python (`venv`) в директории `rss_telegram_bot`.
2.  Создадут `venv`, если оно не найдено.
3.  Активируют `venv`.
4.  Установят или обновят все необходимые зависимости из файла `requirements.txt`.
5.  Запустят бота (`python -m rss_telegram_bot.bot`).
6.  После остановки бота (например, по Ctrl+C) деактивируют `venv`.

При первом запуске будет автоматически создана и инициализирована база данных (если используется SQLite по умолчанию).

## Использование

1.  Запустите бота с помощью стартового скрипта.
2.  Найдите вашего бота в Telegram по имени пользователя, которое вы задали при создании у @BotFather.
3.  Отправьте команду `/start`.
4.  Используйте кнопки в меню для управления лентами, каналами и подписками.

## Локализация

Бот поддерживает несколько языков.

*   **Выбор языка:** Пользователь может выбрать язык через меню "Настройки" -> "Выбрать язык".
*   **Добавление нового языка:**
    1.  Создайте новый JSON-файл в директории `rss_telegram_bot/locales/` (например, `de.json` для немецкого). Имя файла должно соответствовать коду языка (ISO 639-1).
    2.  Скопируйте структуру из `en.json` или `ru.json` и переведите все строки.
    3.  Добавьте новый код языка (например, `'de'`) в список `SUPPORTED_LANGUAGES` в файле `rss_telegram_bot/constants.py`.
    4.  Перезапустите бота. Новый язык появится в меню выбора.

## Зависимости

Все необходимые библиотеки перечислены в файле `requirements.txt` и устанавливаются автоматически стартовыми скриптами.
